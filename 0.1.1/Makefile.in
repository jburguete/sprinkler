CFLAGS = @CFLAGS@ @XML_CFLAGS@ @GLIB_CFLAGS@ @GSL_CFLAGS@ -O2 -Wall
LIBS = @LDFLAGS@ @LIBS@ @XML_LIBS@ @GLIB_LIBS@ @GSL_LIBS@
CC = @CC@ @ARCH@ @LTO@ @STD@
EXE = @EXE@

sprinkler = sprinkler$(EXE)
invert = invert$(EXE)
drops = drops$(EXE)
obj = trajectory.o drop.o air.o utils.o

all: $(sprinkler) $(invert) $(drops)

$(sprinkler): sprinkler_drop.c sprinkler.o $(obj) Makefile
	$(CC) $(CFLAGS) sprinkler_drop.c sprinkler.o $(obj) $(LIBS) -o $(sprinkler)

$(invert): invert.c jet.o $(obj) Makefile
	$(CC) $(CFLAGS) invert.c jet.o $(obj) $(LIBS) -o $(invert)

$(drops): drops.c Makefile
	$(CC) $(CFLAGS) drops.c $(LIBS) -o $(drops)

utils.o: utils.c utils.h config.h Makefile
	$(CC) $(CFLAGS) utils.c -c -o utils.o

air.o: air.c air.h utils.h config.h Makefile
	$(CC) $(CFLAGS) air.c -c -o air.o

drop.o: drop.c drop.h air.h utils.h config.h Makefile
	$(CC) $(CFLAGS) drop.c -c -o drop.o

trajectory.o: trajectory.c trajectory.h drop.h air.h utils.h config.h Makefile
	$(CC) $(CFLAGS) trajectory.c -c -o trajectory.o

sprinkler.o: sprinkler.c sprinkler.h trajectory.h drop.h air.h utils.h \
	config.h Makefile
	$(CC) $(CFLAGS) sprinkler.c -c -o sprinkler.o

jet.o: jet.c jet.h trajectory.h drop.h utils.h air.h config.h Makefile
	$(CC) $(CFLAGS) jet.c -c -o jet.o
