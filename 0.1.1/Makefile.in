CFLAGS = @CFLAGS@ @XML_CFLAGS@ @GSL_CFLAGS@ -O2 -Wall
LIBS = @LDFLAGS@ @LIBS@ @XML_LIBS@ @GSL_CFLAGS@
CC = @CC@ @ARCH@ @LTO@ @STD@
EXE = @EXE@

trajectory = trajectory$(EXE)
drops = drops$(EXE)
invert = invert$(EXE)

all: $(trajectory) $(drops) $(invert)

$(trajectory): trajectory.c sprinkler.o drop.o air.o utils.o Makefile
	$(CC) $(CFLAGS) trajectory.c sprinkler.o drop.o air.o utils.o $(LIBS) \
		-o $(trajectory)

$(drops): drops.c Makefile
	$(CC) $(CFLAGS) drops.c $(LIBS) -o $(drops)

$(invert): invert.c drop.o Makefile
	$(CC) $(CFLAGS) invert.c drop.o $(LIBS) -o $(invert)

utils.o: utils.c utils.h Makefile
	$(CC) $(CFLAGS) utils.c -c -o utils.o

air.o: air.c air.h utils.h Makefile
	$(CC) $(CFLAGS) air.c -c -o air.o

drop.o: drop.c drop.h air.h utils.h Makefile
	$(CC) $(CFLAGS) drop.c -c -o drop.o

sprinkler.o: sprinkler.c sprinkler.h Makefile
	$(CC) $(CFLAGS) sprinkler.c -c -o sprinkler.o
